<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.marketdongnae.mapper.CommunityMapper">

	<!-- 게시판 불러오기 -->
	<select id="communityAll" resultType="com.marketdongnae.domain.community.CommunityAllDTO">
		SELECT * FROM dongnae.communityall
	</select>
	
	<!-- 게시판 상세보기 -->
	<select id="communityDetail" resultType="com.marketdongnae.domain.community.CommunityAllDTO">
		SELECT * FROM dongnae.communityall where mu_id = #{mu_id}
	</select>
	
	<!-- 조회수 증가 -->
	<update id="updateCount" parameterType="string" >
		update community 
		set community.mu_c =  community.mu_c +1
		where community.mu_id = #{mu_id}	
	</update>
	
	<!-- 글작성 -->
	<insert id="insertCommunity" parameterType="com.marketdongnae.domain.community.communityDetailDTO">
		insert into community( mu_name, mu_detail, mu_i1, mu_i2, mu_i3, ca_id, m_number)
		value(#{mu_name},#{mu_detail},#{mu_i1},#{mu_i2},#{mu_i3},#{ca_id},#{m_number})
	</insert>
		
	
	
	<update id="updateCommunity" parameterType="com.marketdongnae.domain.community.communityDetailDTO">
		update community
		set mu_name = #{mu_name},
			mu_detail = #{mu_detail},
			mu_i1 =#{mu_i1},
			mu_i2 =#{mu_i2},
			mu_i3 =#{mu_i3},
			ca_id =#{ca_id}
		where community.mu_id = #{mu_id}
	</update>
	
	<delete id="deleteCommunity" parameterType="com.marketdongnae.domain.community.communityDetailDTO">
		delete from community where community.mu_id = #{mu_id}
	</delete>
	
	
	
	<select id="heartview" resultType="com.marketdongnae.domain.community.HeartDTO">
		select * from heartView where m_id = #{m_id} and mu_id = #{mu_id}
	</select>
	
	<insert id="insertHeart" parameterType="com.marketdongnae.domain.community.HeartDTO">
		insert into heart(mu_id,m_number,h_num)
			values(#{mu_id},#{m_number},1)
	</insert>
	
	<delete id="deleteHeart" parameterType="com.marketdongnae.domain.community.HeartDTO">
		delete from heart where m_number = #{m_number} and mu_id = #{mu_id}
	</delete>
	
</mapper>